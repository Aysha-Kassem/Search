<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API</title>
    <style>
        .pages {
            text-align: center;
            padding: 10px;
        }

        .pages a {
            padding: 20px;
            text-decoration: none;
            color: black;
        }
    </style>
</head>

<body>
    <div class="pages">
        <a href="index.html">ECMAScript</a>
        <a href="API.html">API</a>
    </div>
    <hr>
    <h1>Bringing the data of API in JavaScript</h1>
    <p>
        Here is the data fetched from the API:
        <br>
        <code>
            // JSON data from the API 
            <br>
            { <br>
                "name": "John Doe", <br>
                "age": 30, <br>
                "city": "New York" <br>
            } 
        </code>
        <br>
        This data is fetched using JavaScript and the Fetch API. <br>
        Bringing data from an API in JavaScript is commonly done using the fetch API, which is a modern and flexible
        approach for making network requests. Here's how you can do it:
        <br> <br>
        The API endpoint used is <a
            href="https://jsonplaceholder.typicode.com/users/1">https://jsonplaceholder.typicode.com/users/1</a>.
        <br>
        The response is in JSON format.
        <br>
        This is just a simple example. In a real-world application, you would likely need to handle errors, make
        multiple requests, and handle pagination.
    </p>

    <br> <br>
    <p>
        1- Basic Example Using Fetch <br>
        <code>
            fetch('https://jsonplaceholder.typicode.com/users/1') <br>
            .then(response => { <br>
                if (!response.ok) { <br>
                    throw new Error('Network response was not ok ' + response.statusText); <br> 
                } <br>
                return response.json(); // parsing the JSON response <br>
            }) <br>
            .then(data => { <br> 
                console.log(data); // handle the data from the API <br>
            }) <br>
            .catch(error => { <br>
                console.error('There has been a problem with your fetch operation:', error); <br>
            }); <br> 
        </code>
    </p>
    <div id="fetch1"></div>

    <br> <br>
    <p>
        2- Using Async/Await <br>
        For a cleaner and more readable approach, especially when dealing with multiple asynchronous operations, you can
        use async and await: <br>
        <code>
            async function fetchData() { <br>
                try { <br>
                    const response = await fetch('https://jsonplaceholder.typicode.com/users/1);  <br>
                    if (!response.ok) {  <br>
                        throw new Error('Network response was not ok' + response.statusText);  <br>
                    }  <br>
                    const data = await response.json();  <br>
                    console.log(data);  <br>
                } catch (error) {  <br>
                    console.error('There has been a problem with your fetch operation:', error);  <br>
                }
            }  <br>
            fetchData(); // Call the function to 
        </code>
    </p>
    <div id="fetch2"></div>

    <br> <br>
    <p>
        3- Handling Different HTTP Methods <br>
        You can also use the fetch API to send data to the server using different HTTP methods like POST, PUT, DELETE,
        etc. <br>
        <code>
            async function postData(url = '', data = {}) { <br>
                const response = await fetch(url, { <br>
                  method: 'POST', // HTTP method <br>
                  headers: { <br>
                    'Content-Type': 'application/json' <br>
                  },<br>
                  body: JSON.stringify(data) // convert JavaScript object to JSON <br>
                }); <br>
              
                if (!response.ok) { <br>
                  throw new Error('Network response was not ok ' + response.statusText); <br>
                } <br>
              
                return response.json(); // parsing the JSON response <br>
              } <br>
              
              postData('https://jsonplaceholder.typicode.com/users/1', { key: 'value' }) <br>
                .then(data => { <br>
                  console.log(data); // handle the data from the API <br>
                }) <br>
                .catch(error => { <br>
                  console.error('There has been a problem with your fetch operation:', error); <br>
                }); <br>
              
        </code>
    </p>
    <div id="fetch3"></div>

    <br> <br>
    <p>
        4- Fetch with Additional Options <br>
        You can also pass additional options to the fetch API, such as headers, credentials, and mode. <br>
        <code>
            fetch('https://jsonplaceholder.typicode.com/users/1', { <br>
                method: 'GET', // or 'POST', 'PUT', 'DELETE', etc. <br>
                headers: { <br>
                    'Content-Type': 'application/json', <br>
                    'Authorization': 'Bearer YOUR_TOKEN_HERE' <br>
                }, <br>
                mode: 'cors', // no-cors, cors, same-origin <br>
                cache: 'default', // no-cache, reload, force-cache, only-if-cached <br>
                credentials: 'same-origin', // include, same-origin, omit <br>
                redirect: 'follow', // manual, follow, error <br>
                referrerPolicy: 'no-referrer', // no-referrer, origin, same-origin, strict-origin, etc. <br>
            }) <br>
            .then(response => { <br>
                if (!response.ok) { <br>
                    throw new Error('Network response was not ok ' + response.statusText); <br>
                } <br>
                return response.json(); // parsing the JSON response <br>
            }) <br>
            .then(data => { <br>
                console.log(data); // handle the data from the API <br>
            }) <br>
            .catch(error => { <br>
                console.error('There has been a problem with your fetch operation:', error); <br>
            }); <br>
        </code>
    </p>
    <div id="fetch4"></div>
    <br> <br>

    <p>
        5- Handling Different Content Types <br>
        YIf the API returns a response in a format other than JSON, such as text or Blob, you can parse it accordingly: <br>
        <code>
            fetch('https://jsonplaceholder.typicode.com/posts/1') <br>
            .then(response => { <br>
                if (!response.ok) { <br>
                    throw new Error('Network response was not ok' + response.statusText); <br>
                } <br>
                return response.text(); // parse the response as text <br>
            }) <br>
            .then(data => { <br>
                console.log(data); // handle the text from the API <br>
            }) <br>
            .catch(error => { <br>
                console.error('There has been a problem with your fetch operation:', error); <br>
            }); <br>
        </code>
    </p>
    <div id="fetch5"></div>
    <br> <br>
    
    <p>
        6- Blob Response Example <br>
        If the API returns a response with a content-type of 'application/json', you can still parse it as JSON <br>
        <code>
            fetch('https://jsonplaceholder.typicode.com/posts/1') <br>
            .then(response => { <br>
                if (!response.ok) { <br>
                    throw new Error('Network response was not ok' + response.statusText); <br>
                } <br>
                return response.blob(); // parse the response as a blob <br>
            }) <br>
            .then(blob => { <br>
                const url = URL.createObjectURL(blob); <br>
                console.log(url);<br>
            }) <br>
            .catch(error => { <br>
                console.error('There has been a problem with your fetch operation:', error); <br>
            }); <br>
        </code>
    </p>
    <div id="fetch6"></div>
    <br> <br>

    <p>
        7- XMLttpRequest <br>
        For a more low-level API, you can use XMLHttpRequest: <br>
        <code>
            const xhr = new XMLHttpRequest(); <br>
            xhr.open('GET', 'https://jsonplaceholder.typicode.com/users/1', true); <br>
            xhr.onreadystatechange = function () { <br>
                let data = JSON.parse(xhr.responseText); <br>
                console.log(data); <br>
                document.getElementById('fetch7').innerHTML = JSON.stringify(data, null, 4);
            }
            xhr.send(); <br>
        </code>
    </p>
    <div id="fetch7"></div>
    <br> <br>

    <p>
        8- Axios <br>
        Axios is a popular HTTP client for JavaScript that makes working with the Fetch API easier. <br>
        <code>
            axios.get('https://jsonplaceholder.typicode.com/users/1') <br>
            .then(response => { <br>
                console.log(response.data); <br>
                document.getElementById('fetch8').innerHTML = JSON.stringify(response.data, null, 4);
            }) <br>
            .catch(error => { <br>
                console.error('Error:', error); <br>
            }); <br>
        </code>
    </p>
    <div id="fetch8"></div>
    <br> <br>



    <p>
        Note: In a real-world application, you would likely want to handle errors, make multiple requests, and handle
        pagination.
        Also, remember to sanitize and validate your data before sending it to the server.
    </p>


    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        // 1- Basic Example Using Fetch
        fetch('https://jsonplaceholder.typicode.com/users/1')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok' + response.statusText);
                }
                return response.json();
            })
            .then(data => {
                // console.log(data);
                document.getElementById('fetch1').innerHTML = JSON.stringify(data, null, 4);
            })
            .catch(error => {
                console.error('There has been a problem with your fetch operation:', error);
            });

        // 2- Using Async/Await
        async function fetchData() {
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/users/1');
                if (!response.ok) {
                    throw new Error('Network response was not ok' + response.statusText);
                }
                const data = await response.json();
                // console.log(data);
                document.getElementById('fetch2').innerHTML = JSON.stringify(data, null, 4);
            } catch (error) {
                console.error('There has been a problem with your fetch operation:', error);
            }
        }
        fetchData(); // Call the function to fetch data from the API endpoint

        // 3- Handling Different HTTP Methods
        async function postData(url = '', data = {}) {
            const response = await fetch(url, {
                method: 'GET', // HTTP method
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data) // convert JavaScript object to JSON
            });
            if (!response.ok) {
                throw new Error('Network response was not ok ' + response.statusText);
            }
            return response.json(); // parsing the JSON response
        }
        postData('https://jsonplaceholder.typicode.com/users/1', { key: 'value' })
            .then(data => {
                console.log(data); // handle the data from the API
                document.getElementById('fetch3').innerHTML = JSON.stringify(data, null, 4);
            })
            .catch(error => {
                console.error('There has been a problem with your fetch operation:', error);
            });

        // 4- Fetch with Additional Options
        fetch('https://jsonplaceholder.typicode.com/users/1', {
            method: 'GET', // or 'POST', 'PUT', 'DELETE', etc.
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer YOUR_TOKEN_HERE'
            },
            mode: 'cors', // no-cors, cors, same-origin
            cache: 'default', // no-cache, reload, force-cache, only-if-cached
            credentials: 'same-origin', // include, same-origin, omit
            redirect: 'follow', // manual, follow, error
            referrerPolicy: 'no-referrer' // no-referrer, origin, same-origin, strict-origin, etc.
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok ' + response.statusText);
                }
                return response.json(); // parsing the JSON response
            })
            .then(data => {
                // console.log(data); // handle the data from the API
                document.getElementById('fetch4').innerHTML = JSON.stringify(data, null, 4);
            })
            .catch(error => {
                console.error('There has been a problem with your fetch operation:', error);
            });



        // 5- Handling Different Content Types
        fetch('https://jsonplaceholder.typicode.com/users/1')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok' + response.statusText);
                }
                return response.text(); // parse the response as text
            })
            .then(data => {
                // console.log(data);
                document.getElementById('fetch5').innerHTML = data;
            })
            .catch(error => {
                console.error('There has been a problem with your fetch operation:', error);
            });


        // 6- Blob Response Example
        fetch('https://jsonplaceholder.typicode.com/posts/1')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok' + response.statusText);
                }
                return response.blob(); // parse the response as a blob
            })
            .then(blob => {
                const url = URL.createObjectURL(blob);
                // console.log(url);
                document.getElementById('fetch6').innerHTML = `<a href="${url}">Download Blob</a>`;
            })
            .catch(error => {
                console.error('There has been a problem with your fetch operation:', error);
            });


        // 7- XMLHttpRequest Example
        const xhr = new XMLHttpRequest();
        xhr.open('GET', 'https://jsonplaceholder.typicode.com/users/1', true);
        xhr.onreadystatechange = function () {
            if (xhr.readyState === XMLHttpRequest.DONE) {
                if (xhr.status === 200) {
                    const data = JSON.parse(xhr.responseText);
                    // console.log(data);
                    document.getElementById('fetch7').innerHTML = JSON.stringify(data, null, 4);
                } else {
                    console.error('There has been a problem with your fetch operation:', xhr.statusText);
                }
            }
        };
        xhr.send();

        // 8- Axios Example
        axios.get('https://jsonplaceholder.typicode.com/users/1')
            .then(response => {
                // console.log(response.data);
                document.getElementById('fetch8').innerHTML = JSON.stringify(response.data, null, 4);
            })
            .catch(error => {
                console.error('Error:', error);
            });
    </script>
</body>

</html>
